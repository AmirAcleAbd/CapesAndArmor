<?xml version="1.0" encoding="utf-8" ?>
<Patch>

  <!--Capes-->
  <Operation Class="PatchOperationReplace">
    <xpath>Defs/ApparelLayerDef[defName="EyeCover"]/label</xpath>
    <value>
      <label>Drape</label>
    </value>
  </Operation>

  <Operation Class="PatchOperationReplace">
    <xpath>Defs/ThingDef[defName="Apparel_Duster"]/apparel/layers</xpath>
    <value>
      <layers>
        <li>Cape</li>
        <li>Armor_Cape</li>
      </layers>
    </value>
  </Operation>

  <Operation Class="PatchOperationAdd">
    <xpath>Defs/ThingDef[defName="Apparel_Duster"]/apparel</xpath>
    <value>
      <drawData>
        <dataNorth>
          <layer>90</layer>
        </dataNorth>
      </drawData>
    </value>
  </Operation>

  <!--hoods-->
  <Operation Class="PatchOperationReplace">
    <xpath>Defs/ThingDef[defName="Apparel_HatHood"]/apparel/layers</xpath>
    <value>
      <layers>
        <li>EyeCover</li>
      </layers>
    </value>
  </Operation>

  <Operation Class="PatchOperationReplace">
    <xpath>Defs/ThingDef[@Name="CowboyHat"]/apparel/layers</xpath>
    <value>
      <layers>
        <li>EyeCover</li>
      </layers>
    </value>
  </Operation>

  <Operation Class="PatchOperationReplace">
    <xpath>Defs/ThingDef[defName="Apparel_TribalHeaddress"]/apparel/layers</xpath>
    <value>
      <layers>
        <li>EyeCover</li>
      </layers>
    </value>
  </Operation>

  <Operation Class="PatchOperationReplace" >
    <xpath>Defs/ThingDef[defName="Apparel_Tuque"]/apparel/layers</xpath>
    <value>
      <layers>
        <li>EyeCover</li>
      </layers>
    </value>
  </Operation>

  <!--Royalty-->

  <Operation Class="PatchOperationFindMod">
    <mods>
      <li>Royalty</li>
    </mods>
    <match Class="PatchOperationSequence">
      <operations>

        <li Class="PatchOperationAdd">
          <xpath>Defs/ThingDef[defName="Apparel_Gunlink"]/apparel</xpath>
          <value>  
            <layers Inherit = "False">
              <li>EyeCover</li>
            </layers>
          </value>
        </li>

        <li Class="PatchOperationAdd">
          <xpath>Defs/ThingDef[defName="Apparel_ArmorMarineHelmetPrestige"]/apparel</xpath>
          <value>
            <layers>
              <li>Overhead</li>
              <li>EyeCover</li>
            </layers>
          </value>
        </li>

        <li Class="PatchOperationReplace">
          <xpath>Defs/ThingDef[defName="Apparel_Crown"]/apparel/layers</xpath>
          <value>
            <layers>
              <li>EyeCover</li>
            </layers>
          </value>
        </li>

        <li Class="PatchOperationReplace">
          <xpath>Defs/ThingDef[defName="Apparel_Coronet"]/apparel/layers</xpath>
          <value>
            <layers>
              <li>EyeCover</li>
            </layers>
          </value>
        </li>

        <li Class="PatchOperationReplace">
          <xpath>Defs/ThingDef[defName="Apparel_Beret"]/apparel/layers</xpath>
          <value>
            <layers>
              <li>EyeCover</li>
            </layers>
          </value>
        </li>    

        <li Class="PatchOperationReplace">
          <xpath>Defs/ThingDef[@Name="ApparelHatRoyalTier2"]/apparel/layers</xpath>
          <value>
            <layers>
              <li>EyeCover</li>
            </layers>
          </value>
        </li>

        <li Class="PatchOperationAdd">
            <xpath>Defs/ThingDef[defName="Apparel_HatTop"]/apparel</xpath>
            <value>
                <layers>
                    <li>Overhead</li>
                </layers>
            </value>
        </li> 

        <li Class="PatchOperationReplace">
            <xpath>Defs/ThingDef[defName="Apparel_PsyfocusHelmet"]/apparel/layers</xpath>
            <value>
                <layers>
                    <li>EyeCover</li>
                </layers>
            </value>
        </li>
      </operations>
    </match>
  </Operation>  

  <!--Idealogy-->

  <Operation Class="PatchOperationFindMod">
    <mods>
      <li>Ideology</li>
    </mods>
    <match Class="PatchOperationSequence">
      <operations>
        <li Class="PatchOperationReplace">
          <xpath>Defs/ThingDef[defName="Apparel_AuthorityCap"]/apparel/layers</xpath>
          <value>
            <layers>
              <li>EyeCover</li>
            </layers>
          </value>
        </li>

        <li Class="PatchOperationReplace">
          <xpath>Defs/ThingDef[defName="Apparel_Tailcap"]/apparel/layers</xpath>
          <value>
            <layers>
              <li>EyeCover</li>
            </layers>
          </value>
        </li>

        <li Class="PatchOperationReplace">
          <xpath>Defs/ThingDef[defName="Apparel_Shadecone"]/apparel/layers</xpath>
          <value>
            <layers>
              <li>EyeCover</li>
            </layers>
          </value>
        </li>

        <li Class="PatchOperationReplace">
          <xpath>Defs/ThingDef[defName="Apparel_TortureCrown"]/apparel/layers</xpath>
          <value>
            <layers>
              <li>EyeCover</li>
            </layers>
          </value>
        </li>

        <li Class="PatchOperationReplace">
          <xpath>Defs/ThingDef[defName="Apparel_Flophat"]/apparel/layers</xpath>
          <value>
            <layers>
              <li>EyeCover</li>
            </layers>
          </value>
        </li>
      </operations>
    </match>
  </Operation>

  <!--Biotech-->

  <Operation Class="PatchOperationFindMod">
    <mods>
      <li>Biotech</li>
    </mods>
    <match Class="PatchOperationSequence">
      <operations>
        <li Class="PatchOperationAdd">
          <xpath>Defs/ThingDef[@Name="ApparelArmorHelmetMechanitorBase"]</xpath>
          <value>
            <apparel>
              <bodyPartGroups>
                <li>FullHead</li>
              </bodyPartGroups>
              <layers>
                <li>EyeCover</li>
              </layers>
              <defaultOutfitTags>
                <li>Soldier</li>
              </defaultOutfitTags>
              <useDeflectMetalEffect>true</useDeflectMetalEffect>
            </apparel>
          </value>
        </li>

        <li Class="PatchOperationReplace">
          <xpath>Defs/ThingDef[defName="Apparel_Bandolier"]/apparel/layers</xpath>
          <value>
            <layers>
              <li>Cape</li>
              <li>Armor_Cape</li>
            </layers>
          </value>
        </li>
        
        <li Class="PatchOperationAdd">
          <xpath>Defs/ThingDef[defName="Apparel_Bandolier"]/apparel</xpath>
          <value>
            <drawData>
              <scaleOffsetByBodySize>true</scaleOffsetByBodySize>
              <bodyTypeScales>
                <Hulk>1.1</Hulk>
              </bodyTypeScales>
              <defaultData>
                <layer>45</layer>
              </defaultData>
              <dataNorth>
                <layer>90</layer>
              </dataNorth>
            </drawData>
          </value>
        </li>

        <li Class="PatchOperationReplace">
          <xpath>Defs/ThingDef[defName="Apparel_Sash"]/apparel/layers</xpath>
          <value>
            <layers>
              <li>Cape</li>
              <li>Armor_Cape</li>
            </layers>
          </value>
        </li>
        
        <li Class="PatchOperationAdd">
          <xpath>Defs/ThingDef[defName="Apparel_Sash"]/apparel</xpath>
          <value>
            <drawData>
              <scaleOffsetByBodySize>true</scaleOffsetByBodySize>
              <bodyTypeScales>
                <Hulk>1.03</Hulk>
                <Thin>1.1</Thin>
              </bodyTypeScales>
              <defaultData>
                <layer>45</layer>
              </defaultData>
              <dataNorth>
                <layer>90</layer>
              </dataNorth>
            </drawData>
          </value>
        </li>
      </operations>
    </match>
  </Operation>

  <!--Anomaly-->

  <Operation Class="PatchOperationFindMod">
    <mods>
      <li>Anomaly</li>
    </mods>
    <match Class="PatchOperationReplace">
      <xpath>Defs/ThingDef[defName="Apparel_CeremonialCultistMask"]/apparel/layers</xpath>
      <value>
        <layers>
          <li>Overhead</li>
          <li>EyeCover</li>
        </layers>
      </value>
    </match>
  </Operation>

</Patch>


