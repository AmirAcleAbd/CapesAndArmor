<?xml version="1.0" encoding="utf-8" ?>
<Patch>

  <Operation Class="PatchOperationReplace">
    <xpath>Defs/ThingDef[defName="Apparel_Cape"]/apparel/layers</xpath>
    <value>
      <layers>
        <li>Cape</li>
        <li>Armor_Cape</li>
      </layers>
    </value>
  </Operation>

  <Operation Class="PatchOperationAdd">
    <xpath>Defs/ThingDef[defName="Apparel_Cape"]/apparel</xpath>
    <value>
      <drawData>
        <dataNorth>
          <layer>52</layer>
        </dataNorth>
      </drawData>
    </value>
  </Operation>


  <Operation Class="PatchOperationReplace">
    <xpath>Defs/ThingDef[defName="Apparel_FlakJacket"]/apparel/layers</xpath>
    <value>
      <layers>
        <li>Shell</li>
        <li>Cape</li>
      </layers>
    </value>
  </Operation>

  <!--Royalty-->

  <Operation Class="PatchOperationFindMod">
    <mods>
      <li>Royalty</li>
    </mods>
    <match Class="PatchOperationSequence">
      <operations>
        <li Class="PatchOperationReplace">
          <xpath>Defs/ThingDef[@Name="ApparelArmorCataphractBase"]/apparel/layers</xpath>
          <value>
            <layers>
              <li>Middle</li>
              <li>Shell</li>
              <li>Cape</li>
            </layers>
          </value>
        </li>

        <li Class="PatchOperationAdd">
          <xpath>Defs/ThingDef[defName="Apparel_ArmorLocust"]/apparel</xpath>
          <value>
            <layers>
              <li>Cape</li>
            </layers>
          </value>
        </li>

        <li Class="PatchOperationAdd">
          <xpath>Defs/ThingDef[defName="Apparel_ArmorMarinePrestige"]/apparel</xpath>
          <value>
            <layers>
              <li>Cape</li>
            </layers>
          </value>
        </li>

        <li Class="PatchOperationReplace">
          <xpath>Defs/ThingDef[defName="Apparel_PsyfocusRobe"]/apparel/layers</xpath>
          <value>
            <layers>
              <li>Cape</li>
              <li>Armor_Cape</li>
            </layers>
          </value>
        </li>

        <li Class="PatchOperationReplace">
          <xpath>Defs/ThingDef[defName="Apparel_RobeRoyal"]/apparel/layers</xpath>
          <value>
            <layers>
              <li>Cape</li>
              <li>Armor_Cape</li>
            </layers>
          </value>
        </li>

        <li Class="PatchOperationAdd"> 
          <xpath>Defs/ThingDef[defName="Apparel_PsyfocusRobe"]/apparel</xpath>
          <value>
            <drawData>
              <scaleOffsetByBodySize>true</scaleOffsetByBodySize>
              <bodyTypeScales>
                <Thin>1.1</Thin>
              </bodyTypeScales>
              <dataNorth>
                <layer>52</layer>
              </dataNorth>
            </drawData>
          </value>
        </li>

        <li Class="PatchOperationAdd">
          <xpath>Defs/ThingDef[defName="Apparel_RobeRoyal"]/apparel</xpath>
          <value>
            <drawData>
              <scaleOffsetByBodySize>true</scaleOffsetByBodySize>
              <bodyTypeScales>
                <Thin>1.1</Thin>
              </bodyTypeScales>
              <dataNorth>
                <layer>52</layer>
              </dataNorth>
            </drawData>
          </value>
        </li>
      </operations>
    </match>
  </Operation>

  <!--Ideology-->

  <Operation Class="PatchOperationFindMod">
    <mods>
      <li>Ideology</li>
    </mods>
    <match Class="PatchOperationSequence">
      <operations>
        <li Class="PatchOperationReplace">
          <xpath>Defs/ThingDef[defName="Apparel_BodyStrap"]/apparel/layers</xpath>
          <value>
            <layers>
              <li>Armor_Cape</li>
            </layers>
          </value>
        </li>

        <li Class="PatchOperationAdd">
          <xpath>Defs/ThingDef[defName="Apparel_BodyStrap"]/apparel</xpath>
          <value>
            <drawData>
              <defaultData>
                <layer>19</layer>
              </defaultData>
            </drawData>
          </value>
        </li>

        <li Class="PatchOperationReplace">
          <xpath>Defs/ThingDef[defName="Apparel_Blindfold"]/apparel/bodyPartGroups</xpath>
          <value>
            <bodyPartGroups>
              <li>Mouth</li>
            </bodyPartGroups>
          </value>
        </li>

        <li Class="PatchOperationReplace">
          <xpath>Defs/ThingDef[defName="Apparel_Collar"]/apparel/bodyPartGroups</xpath>
          <value>
            <bodyPartGroups>
              <li>Mouth</li>
            </bodyPartGroups>
          </value>
        </li>
      </operations>
    </match>
  </Operation>

</Patch>


